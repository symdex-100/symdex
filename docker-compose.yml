services:
  symdex:
    build: .
    working_dir: /app
    env_file:
      - .env
    environment:
      # When path="." the server uses /data (mounted project). Omit to use container CWD.
      SYMDEX_DEFAULT_PATH: "/data"
    volumes:
      # CODE_DIR should point to the project you want to index.
      - "${CODE_DIR:-.}:/data"

    # Default: run MCP server (HTTP/Streamable) for Smithery / remote clients.
    # For CLI only: command: ["symdex", "--help"]
    # For stdio (local Cursor): command: ["symdex", "mcp", "--transport", "stdio"]
    command: ["symdex", "mcp", "--transport", "streamable-http"]
